# Main_Server ìµœì¢… í™•ì¸ ê²°ê³¼ (2025-01-28)

## ğŸ” í˜„ì¬ ìƒí™©

### í™•ì¸ëœ ì‚¬ì‹¤

1. **Output ë””ë ‰í† ë¦¬**: ë¹„ì–´ìˆìŒ
2. **Templates ë””ë ‰í† ë¦¬**: ì •ìƒ (test/obj_000005ì— 126ê°œ íŒŒì¼)
3. **ì½”ë“œ êµ¬í˜„**: ì™„ë£Œë˜ì–´ ìˆìŒ
4. **ì„œë²„ ìƒíƒœ**: ì •ìƒ (ISM, PEM, Render ëª¨ë‘ ì •ìƒ)

## ğŸ“‹ êµ¬í˜„ í™•ì¸

### âœ… ì™„ë£Œëœ ê¸°ëŠ¥

#### 1. í…œí”Œë¦¿ ì²˜ë¦¬ (144-152ì¤„)
```python
if not template_dir.exists():
    render_result = await self._call_render_server(...)
else:
    results["render"] = {"skipped": True}
```
- âœ… í…œí”Œë¦¿ ì—†ìœ¼ë©´ ìƒì„±
- âœ… í…œí”Œë¦¿ ìˆìœ¼ë©´ ìŠ¤í‚µ

#### 2. ISM ì¶”ë¡  (157-164ì¤„)
```python
ism_result = await self._call_ism_server(
    rgb_path, depth_path, cam_json_path,
    cad_path, template_dir, output_dir
)
```
- âœ… ISM ì„œë²„ í˜¸ì¶œ
- âœ… output_dir ì „ë‹¬

#### 3. PEM ì¶”ë¡  (173-181ì¤„)
```python
pem_result = await self._call_pem_server(
    rgb_path, depth_path, cam_json_path,
    cad_path, template_dir, ism_result_path, output_dir
)
```
- âœ… PEM ì„œë²„ í˜¸ì¶œ
- âœ… output_dir ì „ë‹¬

#### 4. ê²°ê³¼ ë°˜í™˜ (184-188ì¤„)
```python
return {
    "success": True,
    "results": results,
    "output_dir": output_dir
}
```
- âœ… ëª¨ë“  ê²°ê³¼ í¬í•¨
- âœ… output_dir ê²½ë¡œ ë°˜í™˜

## âš ï¸ Output ë””ë ‰í† ë¦¬ê°€ ë¹„ì–´ìˆëŠ” ì´ìœ 

### ê°€ëŠ¥í•œ ì›ì¸

1. **íŒŒì´í”„ë¼ì¸ì´ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ**
   - í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹¤íŒ¨
   - ì„œë²„ ì—°ê²° ë¬¸ì œ

2. **ê²½ë¡œ ë¬¸ì œ**
   - í˜¸ìŠ¤íŠ¸-ì»¨í…Œì´ë„ˆ ê²½ë¡œ ë§¤í•‘ ë¬¸ì œ
   - íŒŒì¼ì´ ë‹¤ë¥¸ ìœ„ì¹˜ì— ì €ì¥ë¨

3. **íŒŒì¼ ì €ì¥ ì‹¤íŒ¨**
   - ISM/PEM ì„œë²„ê°€ íŒŒì¼ì„ ì €ì¥í•˜ì§€ ì•ŠìŒ
   - ê¶Œí•œ ë¬¸ì œ

## ğŸ¯ ì‹¤ì œ í…ŒìŠ¤íŠ¸ í•„ìš”

### ì‹¤í–‰ ë°©ë²•

#### ë°©ë²• 1: Python ìŠ¤í¬ë¦½íŠ¸
```bash
cd Main_Server
python run_and_save.py
```

#### ë°©ë²• 2: API í˜¸ì¶œ
```bash
curl -X POST http://localhost:8001/api/v1/workflow/full-pipeline \
  -H "Content-Type: application/json" \
  -d '{
    "class_name": "test",
    "object_name": "obj_000005",
    "input_images": {
      "rgb_path": "static/test/rgb.png",
      "depth_path": "static/test/depth.png",
      "camera_path": "static/test/camera.json"
    }
  }'
```

#### ë°©ë²• 3: Main Server ì‹¤í–‰ í›„ API í˜¸ì¶œ
```bash
# í„°ë¯¸ë„ 1: Main Server ì‹¤í–‰
cd Main_Server
uvicorn main:app --host 0.0.0.0 --port 8001 --reload

# í„°ë¯¸ë„ 2: API í˜¸ì¶œ
curl -X POST http://localhost:8001/api/v1/workflow/full-pipeline \
  -H "Content-Type: application/json" \
  -d @test_pipeline_request.json
```

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

íŒŒì´í”„ë¼ì¸ì´ ì •ìƒ ì‘ë™í•˜ë©´:

```
static/output/20250128_HHMMSS/
â”œâ”€â”€ ism/
â”‚   â”œâ”€â”€ detection_ism.json
â”‚   â”œâ”€â”€ detection_ism.npz
â”‚   â””â”€â”€ vis_ism.png          # â­ ì‹œê°í™” ì´ë¯¸ì§€
â””â”€â”€ pem/
    â”œâ”€â”€ detection_pem.json
    â””â”€â”€ vis_pem.png          # â­ ì‹œê°í™” ì´ë¯¸ì§€
```

## ğŸ’¡ ìš”ì•½

### âœ… êµ¬í˜„ ìƒíƒœ
- ì½”ë“œ: 100% ì™„ë£Œ
- ë¡œì§: ì •ìƒ
- ê¸°ëŠ¥: ëª¨ë‘ êµ¬í˜„ë¨

### â“ ì‹¤ì œ ì‹¤í–‰
- Output ë””ë ‰í† ë¦¬: ë¹„ì–´ìˆìŒ (íŒŒì¼ ë¯¸ìƒì„±)
- ì›ì¸: ë¯¸í™•ì¸ (ì‹¤ì œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸ í•„ìš”)
- í•´ê²°: íŒŒì´í”„ë¼ì¸ ì‹¤í–‰í•˜ì—¬ í™•ì¸ í•„ìš”

## ğŸ¯ ê²°ë¡ 

**Main_Serverì˜ íŒŒì´í”„ë¼ì¸ ì½”ë“œëŠ” ì™„ë²½í•˜ê²Œ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë‚˜, ì‹¤ì œë¡œ íŒŒì¼ì´ ìƒì„±ë˜ëŠ”ì§€ëŠ” íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.**

í˜„ì¬ output ë””ë ‰í† ë¦¬ê°€ ë¹„ì–´ìˆëŠ” ê²ƒì€ ì•„ì§ íŒŒì´í”„ë¼ì¸ì´ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ê±°ë‚˜, ì‹¤í–‰ë˜ì—ˆì§€ë§Œ íŒŒì¼ ì €ì¥ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸš€ ë‹¤ìŒ ì¡°ì¹˜

1. **Main Server ì‹¤í–‰**
2. **íŒŒì´í”„ë¼ì¸ API í˜¸ì¶œ**
3. **Output ë””ë ‰í† ë¦¬ í™•ì¸**
4. **ìƒì„±ëœ íŒŒì¼ í™•ì¸**

