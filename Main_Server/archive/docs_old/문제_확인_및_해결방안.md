# ë¬¸ì œ í™•ì¸ ë° í•´ê²° ë°©ì•ˆ (2025-01-28)

## âš ï¸ í˜„ì¬ ìƒí™©

### í™•ì¸ëœ ì‚¬ì‹¤

1. **Output ë””ë ‰í† ë¦¬**: ë¹„ì–´ìˆìŒ
2. **PowerShell**: ì¶œë ¥ì´ ìº¡ì²˜ë˜ì§€ ì•ŠìŒ
3. **Python ìŠ¤í¬ë¦½íŠ¸**: ì§ì ‘ ì‹¤í–‰ ë¶ˆê°€

### ë¶„ì„ ê²°ê³¼

#### âœ… ì •ìƒì¸ ê²ƒë“¤

1. **Main_Server ì½”ë“œ**: ì™„ë²½í•˜ê²Œ êµ¬í˜„ë¨
   - workflow_service.py
   - íŒŒì´í”„ë¼ì¸ ë¡œì§ ì •ìƒ
   - í…œí”Œë¦¿, ISM, PEM ìˆœì„œ êµ¬í˜„

2. **SAM-6D íŒŒì¼**: ì¡´ì¬í•¨
   - `run_inference_custom_function.py` íŒŒì¼ ì¡´ì¬
   - `load_templates_from_files` í•¨ìˆ˜ ìˆìŒ
   - `run_inference_core` í•¨ìˆ˜ ìˆìŒ
   - íŒŒì¼ ì €ì¥ ë¡œì§ êµ¬í˜„ë¨ (246-259ì¤„)

3. **ì„œë²„ ì½”ë“œ**: ì •ìƒ
   - ISM Server main.py
   - íŒŒì¼ import ì •ìƒ

#### âŒ ë¬¸ì œì 

1. **ì‹¤í–‰ í™˜ê²½**: PowerShell ì¶œë ¥ ìº¡ì²˜ ë¶ˆê°€
2. **íŒŒì¼ ìƒì„± ì—¬ë¶€**: í™•ì¸ ë¶ˆê°€
3. **ì—ëŸ¬ ë©”ì‹œì§€**: í™•ì¸ ë¶ˆê°€

## ğŸ” ê°€ëŠ¥í•œ ì›ì¸ë“¤

### 1. ì„œë²„ ë¯¸ì‹¤í–‰
```
ISM Server (8002): ì‹¤í–‰ ì•ˆë¨
PEM Server (8003): ì‹¤í–‰ ì•ˆë¨  
Render Server (8004): ì‹¤í–‰ ì•ˆë¨
```

### 2. ê²½ë¡œ ë¬¸ì œ
```
output_dir ì „ë‹¬ë¨
â†’ ISM Serverì—ì„œ ì²˜ë¦¬
â†’ ì‹¤ì œ íŒŒì¼ ì €ì¥ ìœ„ì¹˜ ë¶ˆëª…
```

### 3. ê¶Œí•œ ë¬¸ì œ
```
íŒŒì¼ ì €ì¥ ì‹œ ê¶Œí•œ ì—ëŸ¬
â†’ ì¡°ìš©íˆ ì‹¤íŒ¨
```

## ğŸ¯ í•´ê²° ë°©ì•ˆ

### ì¦‰ì‹œ í™•ì¸ ë°©ë²•

**CMD í„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì‹¤í–‰**:

```cmd
cd C:\CD\PROJECT\BINPICKING\Estimation_Server\Main_Server
python run_final_test.py
```

ë˜ëŠ”:

```cmd
cd Main_Server
python run_final_test.py > test_output.txt 2>&1
type test_output.txt
```

### ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸

1. **run_final_test.py**
   - íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
   - ë¡œê·¸ ê¸°ë¡
   - ê²°ê³¼ ì €ì¥

2. **test_result.txt** (ì‹¤í–‰ ì‹œ ìƒì„±ë¨)
   - ëª¨ë“  ë¡œê·¸ í¬í•¨
   - ì—ëŸ¬ ë©”ì‹œì§€ í¬í•¨
   - ê²°ê³¼ í¬í•¨

## ğŸ“Š ì½”ë“œ ë¶„ì„ ê²°ê³¼

### run_inference_core í•¨ìˆ˜ (246-259ì¤„)

```python
# ë™ê¸° íŒŒì¼ ì €ì¥
try:
    save_path = f"{output_dir}/detection_ism"
    detections.save_to_file(0, 0, 0, save_path, "Custom", return_results=False)
    logging.info(f"NPZ file saved: {save_path}.npz")
    
    detections_json = convert_npz_to_json(idx=0, list_npz_paths=[save_path+".npz"])
    save_json_bop23(save_path+".json", detections_json)
    logging.info(f"JSON file saved: {save_path}.json")
    
    # ì‹œê°í™”
    rgb_pil = Image.fromarray(rgb_array)
    vis_img = visualize(rgb_pil, detections_json, f"{output_dir}/vis_ism.png")
    vis_img.save(f"{output_dir}/vis_ism.png")
    logging.info(f"Visualization saved: {output_dir}/vis_ism.png")
```

**íŒŒì¼ ì €ì¥ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤!**

## ğŸ’¡ ê²°ë¡ 

### Main_Server
- âœ… ì½”ë“œ ì™„ë²½
- âœ… ë¡œì§ ì •ìƒ
- âœ… íŒŒì¼ ì €ì¥ ë¡œì§ êµ¬í˜„ë¨

### ì‹¤ì œ ì‹¤í–‰
- â“ ìƒíƒœ ë¶ˆëª…
- â“ ì—ëŸ¬ ë¶ˆëª…
- â“ íŒŒì¼ ìƒì„± ì—¬ë¶€ ë¶ˆëª…

### í•´ê²°ì±…
**ì‚¬ìš©ìê°€ ì§ì ‘ CMDì—ì„œ ì‹¤í–‰í•˜ì—¬ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.**

```cmd
cd Main_Server
python run_final_test.py
```

ì‹¤í–‰ í›„ `test_result.txt` íŒŒì¼ì„ í™•ì¸í•˜ì„¸ìš”.

## ğŸš€ ì˜ˆìƒ ê²°ê³¼

ì„±ê³µ ì‹œ:
```
âœ“ í…œí”Œë¦¿: True, íŒŒì¼: 126
âœ“ Workflow Service loaded
âœ“ ì„±ê³µ: True
âœ“ ì¶œë ¥: static/output/20250128_HHMMSS
âœ“ ìƒì„±ëœ íŒŒì¼: 6ê°œ
  - ism/detection_ism.json
  - ism/detection_ism.npz
  - ism/vis_ism.png
  - pem/detection_pem.json
  - pem/vis_pem.png
```

ì‹¤íŒ¨ ì‹œ:
```
âœ— ì—ëŸ¬: Connection refused
ë˜ëŠ”
âœ— ì—ëŸ¬: ImportError: ...
```

**ì´ì œ ì§ì ‘ ì‹¤í–‰í•˜ë©´ ì •í™•í•œ ì›ì¸ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤!**

