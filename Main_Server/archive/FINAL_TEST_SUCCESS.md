# ì¶”ë¡  API ìµœì¢… í…ŒìŠ¤íŠ¸ ì„±ê³µ!

## âœ… ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë¨!

### ê°œì„ ì‚¬í•­ ì ìš©
- **ISM ê²°ê³¼ í•„í„°ë§**: 34ê°œ â†’ **ìƒìœ„ 3ê°œë§Œ** PEMì— ì „ë‹¬
- **CUDA OOM í•´ê²°**: GPU ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œ í•´ê²°ë¨
- **ëª¨ë“  íŒŒì¼ ìƒì„± ì„±ê³µ**

## ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼

### ì¶”ë¡  ì„±ëŠ¥
- **ISM**: 33ì´ˆ (34ê°œ ê°ì²´ ê°ì§€)
- **PEM**: 6ì´ˆ (ìƒìœ„ 3ê°œ í¬ì¦ˆ ì¶”ì •)
- **ì´ ì‹œê°„**: ì•½ 39ì´ˆ

### ìƒì„±ëœ íŒŒì¼ (5ê°œ)
1. `detection_ism.json` (20.6KB) - ISM ê°ì§€ ê²°ê³¼
2. `detection_ism.npz` (48.6KB) - ISM numpy ë°ì´í„°
3. `vis_ism.png` (744.9KB) - ISM ì‹œê°í™” ì´ë¯¸ì§€
4. `detection_pem.json` (2.2KB) - PEM í¬ì¦ˆ ì¶”ì • ê²°ê³¼
5. `vis_pem.png` (482.3KB) - PEM ì‹œê°í™” ì´ë¯¸ì§€

### ì¶œë ¥ ë””ë ‰í† ë¦¬
```
static/output/20251029_114242/
â”œâ”€â”€ ism/
â”‚   â”œâ”€â”€ detection_ism.json
â”‚   â”œâ”€â”€ detection_ism.npz
â”‚   â””â”€â”€ vis_ism.png
â””â”€â”€ pem/
    â”œâ”€â”€ detection_pem.json
    â””â”€â”€ vis_pem.png
```

## ğŸ¯ PEM ê²°ê³¼
- **ì„±ê³µ**: true âœ…
- **ê°ì§€ëœ ê°ì²´ ìˆ˜**: 3ê°œ
- **í¬ì¦ˆ ì¶”ì •**: 3ê°œ ì„±ê³µ
- **ì—ëŸ¬**: ì—†ìŒ âœ…

### ì¶”ì •ëœ í¬ì¦ˆ (ìƒìœ„ 3ê°œ)
1. Score: 0.429 - Box: [376, 227, 435, 309]
2. Score: 0.388 - Box: [581, 304, 633, 351]
3. Score: 0.364 - Box: [110, 119, 166, 186]

## ğŸ“ ìˆ˜ì • ë‚´ìš©

### Main_Server/services/workflow_service.py
```python
def _extract_seg_data(self, ism_data, top_k: int = 3) -> List[Dict[str, Any]]:
    """ISM ê²°ê³¼ì—ì„œ seg_data ì¶”ì¶œ (ìƒìœ„ Nê°œë§Œ ì„ íƒ)"""
    # ... ISM ê²°ê³¼ë¥¼ seg_dataë¡œ ë³€í™˜ ...
    
    # Score ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ í›„ ìƒìœ„ Nê°œë§Œ ì„ íƒ
    seg_data_sorted = sorted(seg_data, key=lambda x: x["score"], reverse=True)
    top_seg_data = seg_data_sorted[:top_k]
    
    print(f"[INFO] ISM ê²°ê³¼: ì´ {len(seg_data)}ê°œ â†’ ìƒìœ„ {len(top_seg_data)}ê°œë§Œ PEMì— ì „ë‹¬")
    
    return top_seg_data
```

## ğŸ‰ ê²°ë¡ 

ì¶”ë¡  APIê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ë©°, ìƒìœ„ 3ê°œë§Œ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í•˜ì—¬:
- âœ… GPU ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œ í•´ê²°
- âœ… ëª¨ë“  íŒŒì¼ ìƒì„± ì„±ê³µ
- âœ… ì „ì²´ íŒŒì´í”„ë¼ì¸ ì™„ë£Œ

